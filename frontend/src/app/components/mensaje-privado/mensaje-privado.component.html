<div class="mensajes-privados-container">
  <!-- Header Principal -->
  <div class="header-principal">
    <div class="header-center">
      <h2>Mensajes Privados</h2>
    </div>
  </div>

  <!-- Búsqueda de usuarios -->
  <div class="busqueda-usuarios">
    <form [formGroup]="searchForm">
      <input 
        #searchInput
        type="text" 
        formControlName="busqueda"
        placeholder="Buscar"
        class="input-busqueda"
      />
    </form>
    
    <!-- Resultados de búsqueda -->
    <div *ngIf="usuariosBuscados.length > 0" class="resultados-busqueda">
      <div 
        *ngFor="let usuario of usuariosBuscados"
        class="resultado-item"
        (click)="seleccionarUsuario(usuario)"
      >
        <img 
          [src]="usuario.fotoUsuario || 'assets/default-avatar.png'" 
          [alt]="usuario.nickName"
          class="avatar"
        />
        <div class="usuario-info">
          <div class="nickname">{{ '@' + usuario.nickName }}</div>
          <div class="nombre">{{ usuario.nombre }} {{ usuario.apellido }}</div>
        </div>
      </div>
    </div>

    <div *ngIf="buscandoUsuarios" class="loading">Buscando...</div>
  </div>

  <!-- Lista de conversaciones -->
  <div class="conversaciones" *ngIf="!cargandoConversaciones">
    <div 
      *ngFor="let conv of conversaciones"
      class="conversacion-item"
      (click)="abrirConversacion(conv.usuario)"
    >
      <div class="avatar-container">
        <img 
          [src]="conv.usuario.fotoUsuario || 'assets/default-avatar.png'" 
          [alt]="conv.usuario.nickName"
          class="avatar"
        />
        <span 
          *ngIf="conv.mensajesNoLeidos > 0" 
          class="badge-no-leidos"
        >
          {{ conv.mensajesNoLeidos }}
        </span>
      </div>
      
      <div class="conversacion-info">
        <div class="header-conversacion">
          <span class="nickname">{{ '@' + conv.usuario.nickName }}</span>
          <span class="fecha">{{ formatearFecha(conv.ultimoMensaje.fechaDeCreado) }}</span>
        </div>
        <div class="ultimo-mensaje">
          {{ conv.ultimoMensaje.texto }}
        </div>
      </div>
    </div>

    <div *ngIf="conversaciones.length === 0" class="empty-state">
      <p>No tienes conversaciones aún</p>
      <p>Busca un usuario para comenzar a chatear</p>
    </div>
  </div>

  <div *ngIf="cargandoConversaciones" class="loading">
    Cargando conversaciones...
  </div>
</div>
